# ТЕХНИЧЕСКИЙ КОНТЕКСТ

## Архитектура системы
**Тип:** ETL (Extract, Transform, Load) конвейер
**Паттерн:** Пакетная обработка данных

## Технический стек
- **Язык:** Python 3.x
- **Основные библиотеки:**
  - `pandas` - обработка данных
  - `imaplib` - работа с Gmail
  - `zipfile` - распаковка архивов
  - `openpyxl` - работа с Excel

## Компоненты системы

### 1. Извлечение данных (Extract)
- IMAP подключение к Gmail
- Поиск писем по паттерну "Остатки Подольск от"
- Скачивание ZIP вложений

### 2. Трансформация (Transform)
- Автоматическое определение структуры файлов
- Парсинг остатков с гибким поиском заголовков
- Объединение прайсов и остатков по артикулам
- Применение бизнес-правил

### 3. Загрузка (Load)
- Экспорт в CSV (с локализацией для Excel)
- Экспорт в XLSX
- Структура: Артикул, Наименование, Бренд, Цена, Остатки, Кратность

## Особенности реализации
- Групповая обработка дубликатов артикулов
- Адаптивный парсинг заголовков файлов
- Автоматическое округление цен до сотых
- Платформо-независимая работа с файлами 